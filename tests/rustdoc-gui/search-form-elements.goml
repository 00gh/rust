// This test ensures that the elements in ".search-form" have the expected display.
go-to: "file://" + |DOC_PATH| + "/test_docs/index.html"
show-text: true

define-function: (
    "check-search-colors",
    (
        theme, border, background, search_input_color, search_input_border_focus,
        menu_button_border, menu_button_a_color, menu_button_a_border_hover, menu_a_color,
    ),
    block {
        set-local-storage: {
            "rustdoc-theme": |theme|,
            "rustdoc-use-system-theme": "false",
        }
        reload:
        assert-css: (
            ".search-input",
            {
                "border-color": |border|,
                "background-color": |background|,
                "color": |search_input_color|,
            },
        )
        // Focus on search input.
        focus: ".search-input"
        assert-css: (
            ".search-input",
            {
                "border-color": |search_input_border_focus|,
                "background-color": |background|,
                "color": |search_input_color|,
            },
        )
        assert-css: (
            "#help-button",
            {"border-color": |menu_button_border|},
        )
        assert-css: (
            "#help-button > a",
            {
                "color": |menu_button_a_color|,
                "border-color": |border|,
                "background-color": |background|,
            },
        )
        // Hover help button.
        move-cursor-to: "#help-button"
        assert-css: (
            "#help-button:hover",
            {"border-color": |menu_button_border|},
        )
        assert-css: (
            "#help-button > a",
            {
                "color": |menu_button_a_color|,
                "border-color": |menu_button_a_border_hover|,
                "background-color": |background|,
            },
        )
        // Link color inside
        click: "#help-button"
        assert-css: (
            "#help a",
            {
                "color": |menu_a_color|,
            },
        )
        assert-css: (
            "#settings-menu",
            {"border-color": |menu_button_border|},
        )
        assert-css: (
            "#settings-menu > a",
            {
                "color": |menu_button_a_color|,
                "border-color": |border|,
                "background-color": |background|,
            },
        )
        // Hover settings menu.
        move-cursor-to: "#settings-menu"
        assert-css: (
            "#settings-menu:hover",
            {"border-color": |menu_button_border|},
        )
        assert-css: (
            "#settings-menu:hover > a",
            {
                "color": |menu_button_a_color|,
                "border-color": |menu_button_a_border_hover|,
                "background-color": |background|,
            },
        )
    },
)

call-function: (
    "check-search-colors",
    {
        "theme": "ayu",
        "border": "rgb(92, 103, 115)",
        "background": "rgb(20, 25, 32)",
        "search_input_color": "rgb(255, 255, 255)",
        "search_input_border_focus": "rgb(92, 103, 115)",
        "menu_button_border": "rgb(197, 197, 197)",
        "menu_button_a_color": "rgb(255, 255, 255)",
        "menu_button_a_border_hover": "rgb(224, 224, 224)",
        "menu_a_color": "rgb(57, 175, 215)",
    }
)
call-function: (
    "check-search-colors",
    {
        "theme": "dark",
        "border": "rgb(224, 224, 224)",
        "background": "rgb(240, 240, 240)",
        "search_input_color": "rgb(17, 17, 17)",
        "search_input_border_focus": "rgb(0, 141, 253)",
        "menu_button_border": "rgb(221, 221, 221)",
        "menu_button_a_color": "rgb(0, 0, 0)",
        "menu_button_a_border_hover": "rgb(255, 185, 0)",
        "menu_a_color": "rgb(210, 153, 29)",
    }
)
call-function: (
    "check-search-colors",
    {
        "theme": "light",
        "border": "rgb(224, 224, 224)",
        "background": "rgb(255, 255, 255)",
        "search_input_color": "rgb(0, 0, 0)",
        "search_input_border_focus": "rgb(102, 175, 233)",
        "menu_button_border": "rgb(0, 0, 0)",
        "menu_button_a_color": "rgb(0, 0, 0)",
        "menu_button_a_border_hover": "rgb(113, 113, 113)",
        "menu_a_color": "rgb(56, 115, 173)",
    }
)
